
\usepackage{titletoc}
\usepackage{textcase}
%
\contentsmargin{0pt}
\titlecontents{table}[0pc]{}{\makebox[6em][l]{\thecontentslabel}}{}{\hfill\MakeTextUppercase{\textbf{\thecontentspage}}}
\titlecontents{figure}[0pc]{}{\makebox[6em][l]{\thecontentslabel}}{}{\hfill\MakeTextUppercase{\textbf{\thecontentspage}}} 
\titlecontents{chapter}[0pc]{\addvspace{7pt}}{\makebox[6em][l]{\textbf{Capitolo\nobs\thecontentslabel}}\textbf}{\textbf}{\hfill\MakeTextUppercase{\textbf{\thecontentspage}}\\[-.75em]\rule{\textwidth}{.4pt}}
%
\titlecontents{section}[0pc]{}{\makebox[6em][l]{\thecontentslabel}}{}{\hfill\MakeTextUppercase{\textbf{\thecontentspage}}\\[-.75em]}
\titlecontents{subsection}[1pc]{}{\makebox[6em][l]{\thecontentslabel}}{}{\hfill\MakeTextUppercase{\textbf{\thecontentspage}}\\[-.75em]}
%
\titlecontents*{csection}[0pc]{}{\makebox[6em][l]{\thecontentslabel}}{}{\hfill\MakeTextUppercase{\textbf{\thecontentspage}}}

\usepackage{titlesec}
\renewcommand{\thechapter}{\arabic{chapter}}
\titleformat{\chapter}[display]
{\bfseries\Large}
{\filleft\MakeUppercase{\chaptertitlename} \Huge\thechapter}
{4ex}
{\titlerule
\vspace{2ex}%
\filright}
[\vspace{2ex}%
\titlerule]

\titleformat{\section}
{
\vspace{.8ex}%
\normalfont\bfseries}
{\thesection.}{.5em}{}

\titleformat{\subsection}
{
\vspace{.8ex}%
\normalfont\itshape\bfseries}
{\thesubsection}{.5em}{}

